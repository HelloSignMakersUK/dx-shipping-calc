<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>DX Shipping Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; position: relative; }
    .shipment { border: 1px solid #ccc; padding: 10px; margin-bottom: 20px; }
    .parcel-group { margin-bottom: 10px; }
    .parcel-group input { width: 80px; margin-right: 5px; }
    #result { white-space: pre-wrap; margin-top: 20px; }
    .error { color: red; }
    #cutoff { font-weight: bold; position: absolute; top: 20px; right: 20px; text-align: right; line-height: 1.4; }
    ol li { margin-bottom: 15px; line-height: 1.6; }
  </style>
</head>
<body>
  <h2>DX Shipping Calculator</h2>
  <div id="cutoff">Same Day Collection Cut Off: 11am<br>Estimated Collection: 2â€“3pm</div>
  <div id="shipments"></div>
  <button id="addShipmentBtn">Add Another Consignment</button>
  <br><br>
  <label>Fuel Surcharge (%): <input id="fuel" type="number" value="13.95" required></label>
  <br><br>
  <button id="calculateShippingBtn">Calculate Shipping</button>
  <button id="sendEmailBtn">Send Collection Request</button>

  <p class="error" id="error"></p>
  <div id="result"></div>

  <h3>Instructions</h3>
  <ol>
    <li><strong>Package parcels</strong> securely and attach a delivery note in a plastic envelope to <strong>each parcel</strong>.</li>
    <li><strong>For each destination (or consignment):</strong>
      <ul>
        <li>Enter the <strong>destination postcode</strong>.</li>
        <li>For each parcel, enter <strong>weight and measurements</strong> (length, width, height).</li>
        <li>Click <strong>Add Parcel</strong> to include additional parcels.</li>
      </ul>
    </li>
    <li><strong>Use <a href="https://dm6.dxfreight.co.uk/logon/logon.aspx" target="_blank">Dispatch Manager 6 Light</a></strong>:<br>Depot: <strong>95</strong><br>Account No.: <strong>93022848</strong><br>Password: <strong>b25i3c</strong><br>and complete a <strong>separate consignment entry for each destination</strong>. Use the <strong>SMUK quote number (Q....)</strong> as the <strong>consignment reference</strong> to track which job the consignment relates to.</li>
    <li><strong>Check the Fuel Surcharge</strong>: Only update the fuel surcharge if you have received notification of a change from DX.</li>
    <li><strong>Print a label for each parcel</strong> in the consignment using the Avery A4 labels stored underneath the Brother printer.</li>
    <li><strong>Print two copies of the manifest</strong> (found on Dispatch Manager main menu) once all consignments are completed for the day.</li>
    <li><strong>Driver collection</strong>: When the driver arrives, ask them to sign both manifests. Keep one copy, and give the other to the driver.</li>
  </ol>

  <script>
    const shipmentsDiv = document.getElementById('shipments');

    function addShipment() {
      const shipmentIndex = shipmentsDiv.children.length + 1;
      const shipment = document.createElement('div');
      shipment.className = 'shipment';
      shipment.innerHTML = `
        <h4>Consignment ${shipmentIndex}</h4>
        <label>Destination Postcode: <input class="postcode" required></label><br><br>
        <div class="parcels"></div>
        <button class="addParcelBtn">Add Parcel</button>
      `;
      const parcelsDiv = shipment.querySelector('.parcels');
      const addParcelBtn = shipment.querySelector('.addParcelBtn');
      addParcelBtn.addEventListener('click', () => {
        const parcelIndex = parcelsDiv.children.length + 1;
        const parcel = document.createElement('div');
        parcel.className = 'parcel-group';
        parcel.innerHTML = `Parcel ${parcelIndex}: <input type="number" placeholder="Weight (kg)">
          <input type="number" placeholder="Length (cm)">
          <input type="number" placeholder="Width (cm)">
          <input type="number" placeholder="Height (cm)">
          <button onclick="this.parentNode.remove()">Remove</button><br>`;
        parcelsDiv.appendChild(parcel);
      });
      shipmentsDiv.appendChild(shipment);
      addParcelBtn.click();
    }

    if (shipmentsDiv.children.length === 0) addShipment();
    document.getElementById('addShipmentBtn').addEventListener('click', addShipment);

    document.getElementById('calculateShippingBtn').addEventListener('click', () => {
      document.getElementById('result').textContent = 'Shipping calculation would go here...';
    });

    document.getElementById('sendEmailBtn').addEventListener('click', () => {
      const body = encodeURIComponent('Please arrange collection for the attached consignments.');
      window.location.href = `mailto:?subject=DX Collection Request&body=${body}`;
    });
  </script>
</body>
</html>
